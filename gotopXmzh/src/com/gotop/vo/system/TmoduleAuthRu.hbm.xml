<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.gotop.vo.system.TmoduleAuthRu" table="tModuleAuthRU">
        <composite-id name="id" class="com.gotop.vo.system.TmoduleAuthRuId">
            <key-property name="id" type="java.lang.Integer">
                <column name="ID" />
            </key-property>
            <key-property name="sqdxlx" type="java.lang.Short">
                <column name="SQDXLX" />
            </key-property>
            <key-property name="mkdm" type="java.lang.String">
                <column name="MKDM" length="20" />
            </key-property>
            <key-property name="gndm" type="java.lang.String">
                <column name="GNDM" length="20" />
            </key-property>
        </composite-id>
        <property name="sqsj" type="java.util.Date">
            <column name="SQSJ" length="23" />
        </property>
        <property name="sqr" type="java.lang.Integer">
            <column name="SQR" />
        </property>
    </class> 
<!--按用户ID或是角色的权限,获取权限范围内全部功能菜单 ID,SQDXLX-->
<sql-query name="moudleauthru.getPermitFuns">
<return alias="myfunction" class="com.gotop.vo.util.Tfunction"/>   
select {myfunction}.GNMC as {myfunction.gnmc},{myfunction}.GNLX as {myfunction.gnlx},{myfunction}.MKDM as {myfunction.id.mkdm},
{myfunction}.GNDM as {myfunction.id.gndm},{myfunction}.GNTP as {myfunction.gntp},{myfunction}.GNSJ as {myfunction.gnsj},{myfunction}.GNSX as {myfunction.gnsx}
,{myfunction}.NOTE as {myfunction.note}
from  (select distinct a.* from tFunction a,tModuleAuthRU b 
where a.MKDM=b.MKDM and a.GNDM=b.GNDM and ((b.ID=? and b.SQDXLX=?) or ((?=0) and (b.ID in (select RID from tRole2User where USID=?) and b.SQDXLX=1))))
{myfunction} 
order by {myfunction}.MKDM,{myfunction}.GNDM
</sql-query>        
</hibernate-mapping>
